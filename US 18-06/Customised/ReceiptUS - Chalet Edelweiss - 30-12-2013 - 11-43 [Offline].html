<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> <title>Receipt_Inherit_Printer_Template DUTCH</title><!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> --><!--<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>--><script type="text/javascript" src="http://www.posios.com/js/jquery.min.js"></script><script type="text/javascript" src="http://www.posios.com/js/jquery.tmpl.min.js"></script><script type="text/javascript" src="http://www.posios.com/js/jquery.qrcode.min.js"></script> <!-- https://github.com/jeromeetienne/jquery-qrcode --><script type="text/javascript" src="http://www.posios.com/js/moment.min.js"></script>    <script type="text/javascript">        /*	Array.allIndexOf(searchElement)	  Array [Array] - the array to search within for the searchElement	  searchElement [String] - the desired element with which to find starting indexes	*/	(function(){	  Array.prototype.allIndexOf = function(searchElement) {	    if (this === null) { return [-1]; }	    var len = this.length,	    hasIndexOf = Array.prototype.indexOf, // you know, because of IE	    i = (hasIndexOf) ? this.indexOf(searchElement) : 0,	    n,	    indx = 0,	    result = [];	    if (len === 0 || i === -1) { return [-1]; }	    if (hasIndexOf) {	      // Array.indexOf does exist	      for (n = 0; n <= len; n++) {	        i = this.indexOf(searchElement, indx);	        if (i !== -1) {	          indx = i + 1;	          result.push(i);	        } else {	          return result;	        }	      }	      return result;	    } else {	    // Array.indexOf doesn't exist	      for (n = 0; n <= len; n++) {	        if (this[n] === searchElement) {	          result.push(n);	        }	      }	      return (result.length > 0) ? result : [-1];	    }	  };	})();	</script>	<style type="text/css">		/* HTML */		html,body {			margin: 0px;			width: 100%;			/*width:576px;*/        		}        h1,h2 {            margin: 0px;        }                table { 			border: none;			border-collapse:collapse        }                th {            margin: 0px;        }		img {			max-width:576px;		}		p {			margin: 0px;		}		/* Classes */		.name {			text-align:left;			width: 60%;		}		.amountPaid {				width: 100%;			text-align:right;			}		.price {            text-align:right;			/*width: 7em;*/		}		.tipPaid {			width:100%;			text-align:right;		}        td.total {            width:100%;			text-align:right;        }				td.amountPayed {			width:100%;			text-align:right;			}		.floatLeft {			float: left;		}		.floatRight {			float: right;		}		.borderTop {			border-top: 1px solid black;		}		.borderBottom {			border-bottom: 1px solid black;		}		.borderTop {			border-top: 1px solid black;		}		th.alignLeft {			text-align: left;		}		th.alignRight {			text-align: right;		}		td.alignRight {			text-align: right;		}		.spreadEvenly {			width: 100%;			text-align: center;		}		.topLine {			 border-top: 1px solid black;		}		.widthHundred {			width: 100%;		}		    	/* IDs */        #header {            /*border-bottom: 1px solid black;	*/	        }    				#receiptItemsList {			width: 100%;		}			#totalAmount {						width: 100%;					}		#paymentsTable { 			width: 100%;		}		#totalTip {			width: 100%;		}		#totals {			width: 100%;			/* border-bottom: 1px solid black; */		}		#subtotal {		   	width: 100%;			/*border-bottom: 1px solid black; */	    }				#totalAmount {			width: 100%;		}		#totalTip {				width: 100%;			}		#change	{			width: 100%			}        #footer p {            margin: 0;        }        				#paymentType {            width:100%;        }        #total .right {            text-align:right;        }                #vat {                        width:100%;          }				#netPrice {						width:100%;					}		        #marginClearRight {			clear: right;		}		#marginClearLeft {			clear:left;		}		#firstRow {			width: 10%;		}		#vatPercent {					width: 60%;			}		#gratuityPercent {			width: 60%;		}		#promotionText {			display:inline-block;			width: 80%;			margin-bottom: 5px !important;			}		#promotionTextThin {			display:inline-block;			width: 80%;			border: thin solid black;			margin-bottom: 5px !important;			}		#promotionTextMedium {			display:inline-block;			width: 80%;			/*border: medium solid black; */			margin-bottom: 5px !important;			}		#promotionTextThick {			display:inline-block;			width: 80%;			border: thick solid black;			margin-bottom: 5px !important;			}		#promotionTextDiv {			margin: 5px;		}		#restaurantInfo {			margin: 5px;		}		#takeAwayInfo {			display: inline-block;			width: 100%;			margin: 5px;		}		#qrCode {			margin: 10px;		}		#centeredCompanyInfo {			width: 600px;			margin-left: auto;			margin-right: auto;		}	</style>    <script id="headerTemplate" type="text/x-jquery-tmpl">        <div style="text-align:center">        	<img src="${template.logoUrl}" />        </div>                <br style="clear:both"/>        {{if window.posTemplateAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(template)}}				{{if template.title != ""}}					{{if window.posTitleWithUnderline == 1}}						<div align="center" i21B='bigFontSize' style="text-decoration:underline;">${template.title}</div>					{{else}}						<div align="center" id="title" i21B='bigFontSize' style="visibility:hidden;">${template.title}</div>					{{/if}}				{{/if}}			{{/if}}		{{/if}}		{{if window.posUserAvailable == 1 && window.posTableAvailable == 1 && window.posReceiptAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(user) && checkIfNotZeroEmptyOrNull(table) && checkIfNotZeroEmptyOrNull(receipt.type)}}				{{if template.showWaiterTableTime == 1}} 					<div id="waiter" i21D='defaultFontSize'>						<div class="floatLeft"><p>Table: ${table.name}</p></div>						<div class="floatRight"><p align="right">${dateToString("", 1)}</p></div>						<div class="floatLeft" id="marginClearLeft"><p>Guests: ${receipt.numberOfCustomers}</p></div>						<div class="floatRight" id="marginClearRight"><p>${receipt.oid}</p></div>						{{if isDineIn(receipt.type)}}							<div class="floatLeft" id="marginClearLeft"><p>Dine in</p></div>						{{else}}							<div class="floatLeft" id="marginClearLeft"><p>Take-out</p></div>						{{/if}}						<div class="floatRight" id="marginClearRight"><p>Server: ${user.firstname}</p></div>						{{if window.posCustomerAvailable == 1}}							{{if checkIfNotZeroEmptyOrNull(customer.firstname) && checkIfNotZeroEmptyOrNull(customer.lastname)}}								<div class="floatLeft" id="marginClearLeft"><p><b>${markUpName(customer.firstname)} ${markUpName(customer.lastname)}</b></p></div>							{{else checkIfNotZeroEmptyOrNull(customer.firstname) && !checkIfNotZeroEmptyOrNull(customer.lastname)}}								<div class="floatLeft" id="marginClearLeft"><p><b>${markUpName(customer.firstname)}</b></p></div>							{{else checkIfNotZeroEmptyOrNull(customer.lastname) && !checkIfNotZeroEmptyOrNull(customer.firstname)}}								<div class="floatLeft" id="marginClearLeft"><p><b>${markUpName(customer.lastname)}</b></p></div>							{{/if}}						{{/if}}					 </div>				{{/if}}			{{/if}}		{{/if}}    </script>	<script id="receiptItemsTemplate" type="text/x-jquery-tmpl">		<tr>			{{if price == 0}}				{{if window.posShowZeroValuedPricesProducts == 1 || calculateAdditionsPrices(additionValues) > 0}}					<td id="hiddenRow" style="display:none;">${line}</td>					<td class="amount" i21D='defaultFontSize' id="firstRow">${amount}</td>					<td class="name" i21D='defaultFontSize'>${name}</td>					{{if window.posShowPrice == 1}}						{{if window.posShowAdditions == 1}}							{{if amount < 0 || amount > 1}}								<td class="price" i21D='defaultFontSize'>${((amount*price)/(100+vat)*100).toFixed(2)}</td>							{{else}}								<td class="price" i21D='defaultFontSize'>${((amount*price)/(100+vat)*100).toFixed(2)}</td>							{{/if}}						{{else}}							{{if amount < 0 || amount > 1}}								<td class="price" i21D='defaultFontSize'>${((amount*price + (calculateAdditionsPrices(additionValues)))/(100+vat)*100).toFixed(2)}</td>							{{else}}								<td class="price" i21D='defaultFontSize'>${((amount*price + (calculateAdditionsPrices(additionValues)))/(100+vat)*100).toFixed(2)}</td>							{{/if}}						{{/if}}					{{/if}}				{{else}}					<td></td><td></td><td></td>				{{/if}}			{{else}}				<td id="hiddenRow" style="display:none;">${line}</td>				<td class="amount" i21D='defaultFontSize' id="firstRow">${amount}</td>					<td class="name" i21D='defaultFontSize'>${name}</td>						{{if window.posShowPrice == 1}}					{{if window.posShowAdditions == 1}}						{{if amount < 0 || amount > 1}}							<td class="price" i21D='defaultFontSize'>${((amount*price)/(100+vat)*100).toFixed(2)}</td>						{{else}}							<td class="price" i21D='defaultFontSize'>${((amount*price)/(100+vat)*100).toFixed(2)}</td>						{{/if}}					{{else}}						{{if amount < 0 || amount > 1}}							<td class="price" i21D='defaultFontSize'>${((amount*price + (calculateAdditionsPrices(additionValues)))/(100+vat)*100).toFixed(2)}</td>						{{else}}							<td class="price" i21D='defaultFontSize'>${((amount*price + (calculateAdditionsPrices(additionValues)))/(100+vat)*100).toFixed(2)}</td>						{{/if}}					{{/if}}				{{/if}}			{{/if}}		</tr>				{{if additionValues.length && window.posShowAdditions == 1 && price != 0}}			{{tmpl(additionValues) "#additionValueTemplate"}}		{{else}} 			{{if additionValues.length && window.posShowAdditions == 1 && price == 0 && (window.posShowZeroValuedAdditions == 1 && window.posShowZeroValuedPricesProducts == 1) || calculateAdditionsPrices(additionValues) > 0}}				{{tmpl(additionValues) "#additionValueTemplate"}}			{{/if}}		{{/if}}	</script>   <script id="additionValueTemplate" type="text/x-jquery-tmpl">		<tr>			<td></td>			{{if price == 0}}				{{if window.posShowZeroValuedAdditions == 1}}					{{if info == ""}}							<td class="name" i21S='smallFontSize' style="font-style:italic;" id="firstRow">* ${name}</td>					{{else}}						<td class="name" i21S='smallFontSize' style="font-style:italic;" id="firstRow">* ${info} ${name}</td>					{{/if}}						{{if window.posShowPrice == 1}}							{{if price != 0}}								<td class="price" i21S='smallFontSize' style="font-style:italic;">${((amount*price)/(100+window.posVAT)*100).toFixed(2)}</td>							{{else}}								<td class="price" i21S='smallFontSize' style="font-style:italic;">${((amount*price)).toFixed(2)}</td>							{{/if}}						{{else}}							<td></td>						{{/if}}				{{else}}					<td></td><td></td>				{{/if}}			{{else}}				{{if info == ""}}						<td class="name" i21S='smallFontSize' style="font-style:italic;" id="firstRow">* ${name}</td>				{{else}}					<td class="name" i21S='smallFontSize' style="font-style:italic;" id="firstRow">* ${info} ${name}</td>				{{/if}}									{{if window.posShowPrice == 1}}					{{if price != 0}}						<td class="price" i21S='smallFontSize' style="font-style:italic;">${((amount*price)/(100+window.posVAT)*100).toFixed(2)}</td>					{{else}}						<td class="price" i21S='smallFontSize' style="font-style:italic;">${((amount*price)).toFixed(2)}</td>					{{/if}}				{{else}}					<td></td>				{{/if}}			{{/if}}					</tr>  	</script>	<script id="receiptTotals" type="text/x-jquery-tmpl">		<tr>					<th class="alignLeft" i21D='defaultFontSize'>Total<br><br><br></th>			<td id="totalValue" i21D='defaultFontSize' class="floatRight"><b>${window.posTotal}</b><br><br><br></td>				</tr> 	</script>	<script id="receiptSubtotal" type="text/x-jquery-tmpl">	  	<tr>	   		<th class="alignLeft" i21D='defaultFontSize' style="font-weight: normal;"><br>Subtotal</th>	   		<td id="subtotalValue" i21D='defaultFontSize' class="floatRight"><br>${ roundToFiveCents((calculateSubtotal(receiptItems))) }</td>	  	</tr> 	</script>	<script id="vatTemplate" type="text/x-jquery-tmpl">		{{if window.posVatAvailable == 1}}			{{if price != 0 && vat != 0}}				<tr>					<th id="vatPercent" class='alignLeft' i21D='defaultFontSize' style="font-weight: normal;">Tax</th>					<td id="vatValue" i21D='defaultFontSize' class="alignRight" style='width:40%;'><br>${roundToFiveCents(price - (price/(100.0+window.posVAT)*100))}<br><br><td>				</tr>				{{/if}}		{{/if}}	</script>	<script id="gratuityTemplate" type="text/x-jquery-tmpl">		{{if (priceTypeId > 59 && priceTypeId < 68 && price != 0) || (priceTypeId > 69 && priceTypeId < 78 && price != 0)}}			<tr>				<th id="gratuityPercent" class='alignLeft' i21D='defaultFontSize' style="font-weight: normal;">Gratuity</th>				<td id="gratuityValue" i21D='defaultFontSize' class="alignRight" style='width:40%;'><br>${roundToFiveCents(price)}<br><br><td>			</tr>					{{/if}}	</script>	<script id="tablePaymentTypes" type="text/x-jquery-tmpl">		{{if window.posShowPayments == 1}}			<tr>						<th id="paymentType" i21D='defaultFontSize'><p2 align="left">Payment</p2></td>				<td class="total" i21D='defaultFontSize'><p2 align="right">Amount</p2></td>					</tr>			{{/if}}		</script>	<script id="paymentTypeTemplate" type="text/x-jquery-tmpl">	{{if window.posPaymentsAvailable == 1}}		{{if window.posShowPayments == 1}}			<tr>				<td class="paymentType" i21D='defaultFontSize' id="firstRow">${type}</td>				<td class="total" i21D='defaultFontSize' id="firstRow">${amount.toFixed(2)}</td>			</tr>		{{/if}}	{{/if}}	</script> 	<script id="totalAmountTemplate" type="text/x-jquery-tmpl">		{{if window.posPaymentsAvailable == 1 && window.posReceiptAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(payments) && window.posShowPayments == 1}}				<tr>					{{if payments}}						<td class="totalAmountPaid" i21D='defaultFontSize'><b>Paid</b</td>					{{/if}}										 {{if payments}}						<td class="amountPaid" i21D='defaultFontSize'><b>${getPayment(payments).toFixed(2)}<b></td>					{{/if}}										{{if typeof(payments) == "undefined"}}						<td class="amountPaid" i21D='defaultFontSize'>${receipt.total.toFixed(2)}</td>					{{/if}}						</tr>			{{/if}}		{{/if}}	</script> 	<script id="totalTipTemplate" type="text/x-jquery-tmpl">		{{if window.posPaymentsAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(payments) && window.posShowPayments == 1}}				<tr>					<th class="tip" i21D='defaultFontSize'>+Tip</th>					<td class="tipPaid" i21D='defaultFontSize'>${getTotalTip(payments).toFixed(2)}</td>				</tr>			{{/if}}		{{/if}}	</script>	<script id="changeTemplate" type="text/x-jquery-tmpl">		{{if window.posPaymentsAvailable == 1}}     			<table id="change">				{{if window.posShowPayments == 1}}									<tr>						{{if getChange(receipt.total,payments) > 0}}							<th i21D='defaultFontSize'>Change</th>							<td class="tipPaid" i21D='defaultFontSize'><b>${getChange(receipt.total,payments).toFixed(2)}</b></td>						{{else getChange(receipt.total,payments) < 0}}							<th i21D='defaultFontSize'>Balance</th>							<td class="tipPaid" i21D='defaultFontSize'><b>${ ((getChange(receipt.total,payments)) * -1).toFixed(2)}</b></td>						{{/if}}					</tr>				{{/if}}		{{/if}}	</script>	<script id="footerTemplate" type="text/x-jquery-tmpl">		{{if window.posTemplateAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(completeReceipt.template.thankYouText)}}				{{if window.posEnableThankYouSubline == 1}}					<div i21B='bigFontSize' class="spreadEvenly">						<p><br><br>${completeReceipt.template.thankYouText}</p>					</div>				{{else}}                     					<div i21B='bigFontSize' class="spreadEvenly">						<p><br><br>${completeReceipt.template.thankYouText}</p>					</div>						{{/if}}			{{/if}}			{{if checkIfNotZeroEmptyOrNull(completeReceipt.template.promotionText)}}				{{if window.posEnablePromotionSubline == 1}}					<div i21D='defaultFontSize' id ="promotionTextDiv" class="spreadEvenly">						{{if window.posThicknessOfFramePromotion == 1}}							<p id="promotionTextThin">${completeReceipt.template.promotionText}</p>						{{else window.posThicknessOfFramePromotion == 2}}							<p id="promotionTextMedium">${completeReceipt.template.promotionText}</p>						{{else window.posThicknessOfFramePromotion == 3}}							<p id="promotionTextThick">${completeReceipt.template.promotionText}</p>						{{else}}							<p id="promotionText">${completeReceipt.template.promotionText}</p>						{{/if}}					</div>				{{else}}					<div i21D='defaultFontSize' id ="promotionTextDiv" class="spreadEvenly">						{{if window.posThicknessOfFramePromotion == 1}}							<p id="promotionTextThin">${completeReceipt.template.promotionText}</p>						{{else window.posThicknessOfFramePromotion == 2}}							<p id="promotionTextMedium">${completeReceipt.template.promotionText}</p>						{{else window.posThicknessOfFramePromotion == 3}}							<p id="promotionTextThick">${completeReceipt.template.promotionText}</p>						{{else}}							<p id="promotionText">${completeReceipt.template.promotionText}</p>						{{/if}}					</div>						{{/if}}			{{/if}}		{{/if}}		{{if window.posCustomerAvailable == 1}}			{{if checkIfNotZeroEmptyOrNull(customer)}}				{{if window.posShowCustomerInfo == 1}}					<div id="takeAwayInfo" i21D='defaultFontSize'>						<div class="floatLeft">							{{if checkIfNotZeroEmptyOrNull(customer.firstname) && checkIfNotZeroEmptyOrNull(customer.lastname)}}								<p><b>${markUpName(customer.firstname)} ${markUpName(customer.lastname)}</b></p>							{{else checkIfNotZeroEmptyOrNull(customer.firstname) && !checkIfNotZeroEmptyOrNull(customer.lastname)}}								<p><b>${markUpName(customer.firstname)}</b></p>							{{else checkIfNotZeroEmptyOrNull(customer.lastname) && !checkIfNotZeroEmptyOrNull(customer.firstname)}}								<p><b>${markUpName(customer.lastname)}</b></p>							{{/if}}							{{if checkIfNotZeroEmptyOrNull(customer.street) && checkIfNotZeroEmptyOrNull(customer.streetNumber) && checkIfNotZeroEmptyOrNull(customer.zip) && checkIfNotZeroEmptyOrNull(customer.city)}}								<p>${customer.street} ${customer.streetNumber} ${customer.zip} ${customer.city}</p>							{{/if}}							{{if checkIfNotZeroEmptyOrNull(customer.telephone)}}								<p>${customer.telephone}</p>							{{/if}}							{{if checkIfNotZeroEmptyOrNull(customer.email)}}								<p>${customer.email}</p>							{{/if}}							{{if checkIfNotZeroEmptyOrNull(receipt.type)}}								<p>${receipt.type}</p>							{{/if}}							<p>${dateToString(receipt.deliveryDate, 1)}</p>							{{if checkIfNotZeroEmptyOrNull(customer.credits)}}								<p>New credit balance: ${customer.credits}</p>								{{/if}}						</div>						</div>						{{/if}}			{{/if}}		{{/if}}		<div id="restaurantInfo" i21D='defaultFontSize'>			{{if window.posEnableCustomerInfoCentering == 1 && receipt.url == ""}}				<div id="centeredCompanyInfo" class='spreadEvenly'>			{{else}}				<div class="floatLeft">							{{/if}}				{{if window.posCompanyAvailable == 1 && window.posUserAvailable == 1}}					{{if checkIfNotZeroEmptyOrNull(company)}}							<p><br></p>							<p><b>${company.displayName}</b></p>							<p>${company.streetNumber} ${company.street}</p>							<p>${company.city}, CA ${company.zip}</p>							<p>${company.telephone}</p>							<p>${company.url}</p>							<!--<p><center><br><br>Follow us!<br> Twitter @EdelweissLAX<br>facebook.com/ChaletEdelweissLAX</center></p>-->						</div>						{{/if}}				{{/if}}		</div>		{{if checkIfNotZeroEmptyOrNull(template.bottomLogoUrl)}}			{{if window.posShowBottomLogo == 1}}				{{if window.posEnableBottomLogoTopline == 1}}					<div class="borderTop" style="text-align:center;clear:both">				{{else}}					<div style="text-align:center;clear:both;">				{{/if}}						<img src="${template.bottomLogoUrl}"/>					</div>			{{/if}}		{{/if}}	</script>    <script id="amountDueTemplate" type="text/x-jquery-tmpl">    	<tr>    		<th i21D='defaultFontSize' class="floatLeft">Remaining total</th>    		<td i21D='defaultFontSize' class="floatRight"><b>${(receipt.total + (calculateTip(payments))).toFixed(2)}</b></td>    	</tr>    </script>	<script type="text/javascript">      function dateToString(passedDate, option) {	//var date = new Date(time);	//return moment(date).format('LLL');	if(option == 1) {		if(passedDate)			var date = new Date(passedDate);		else			var date = new Date();			var dd = date.getDate();		var mm = date.getMonth() + 1;		var hh = date.getHours();		var m = date.getMinutes();		if(date.getDate() < 9)			dd = '0' + date.getDate();		if(date.getMonth() < 9)			mm = '0' + (date.getMonth() + 1);		if(date.getHours() < 10)			hh = '0' + hh;		if(date.getMinutes() < 10)			m = '0' + m;		var stringTime = mm + '/' + dd + '/' + date.getFullYear() + ' ' + hh + ":" + m;		return stringTime;	}	if(option == 2) {		var date = new Date();		var dateExtraMonth = date.setDate(date.getDate() + 30);		var dateWithMonth = new Date(dateExtraMonth);		var dd = dateWithMonth.getDate();		var mm = dateWithMonth.getMonth();				if(dd < 10)			dd = '0' + dd;		if(mm < 10)			mm = '0' + mm;		var stringTime = dd + '/' + mm + '/' + date.getFullYear();		return stringTime;	}}function ReceiptItem(amount, name,price) {	this.amount = amount;	this.name = name;	this.price = price;}				function getChange(receiptTotal, payments) {	return getPayment(payments) - receiptTotal - calculateTip(payments);	}function getTotalTip(payments) {	var totalTip = 0;			if(!payments) {		return 0;		}			for (var pIndex in payments) {  		var payment = payments[pIndex];						if(payment) 	  		totalTip += payment.tips;	}				return totalTip;}		function getPayment(payments) {			var totalPayment = 0;			if(!payments) {		return 0;		}			for(var key in payments)		if(payments.hasOwnProperty(key))			if(payments[key].amount > 0)				totalPayment += payments[key].amount;	//var	totalTips = payments.tips;		return totalPayment;	}function checkIfNotZeroEmptyOrNull(passedValue) {	if(typeof passedValue !== "undefined") {		if(!passedValue)			return false;		else			if(passedValue === "" || passedValue.length == 0)				return false;			else				return true;	}}function markUpName(passedName) {	return passedName[0].toUpperCase() + passedName.substring(1);}function isDineIn(receiptType) {	if(receiptType.toUpperCase() == "RESTAURANT" || receiptType.toUpperCase() == "BAR")		return true;	return false;}function removePrice() {    $('#priceHide').remove();}function checkProductOfAdditionHasValueZero(passedId) {	for(var i = 0; i < window.completeReceipt.receipt.receiptItems.length; i++) {		var receiptItem = window.completeReceipt.receipt.receiptItems[i];		if(receiptItem.price == 0) {			for(var j = 0; j < receiptItem.additionValues.length; j++) {				var additionValue = receiptItem.additionValues[j];				if(additionValue.oid == passedId) {					window.alert("True");					return true;				}			}		}	}	return false;}function sortJsonArrayByProperty(objArray, prop, direction){    if (arguments.length<2) throw new Error("sortJsonArrayByProp requires 2 arguments");    var direct = arguments.length>2 ? arguments[2] : 1; //Default to ascending	var intRegex = /^\d+$/;	console.log(objArray);    //if (objArray && objArray.constructor===Array){	if(objArray) {		console.log("test");        var propPath = (prop.constructor===Array) ? prop : prop.split(".");		console.log(propPath);        objArray.sort(function(a,b){            for (var p in propPath){				console.log(p);                if (a[propPath[p]] && b[propPath[p]]){                    a = a[propPath[p]];                    b = b[propPath[p]];                }            }						if(!(intRegex.test(a) && intRegex.test(b))) {				// convert numeric strings to integers				a = a.match(/^\d+$/) ? +a : a;				b = b.match(/^\d+$/) ? +b : b;			}			return ( (a < b) ? -1*direct : ((a > b) ? 1*direct : 0) );        });    }}function dynamicSort(property) {    var sortOrder = 1;    if(property[0] === "-") {        sortOrder = -1;        property = property.substr(1);    }    return function (a,b) {        var result = (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;        return result * sortOrder;    }}var sort_by;(function() {    // utility functions    var default_cmp = function(a, b) {            if (a == b) return 0;            return a < b ? -1 : 1;        },        getCmpFunc = function(primer, reverse) {            var dfc = default_cmp, // closer in scope                cmp = default_cmp;            if (primer) {                cmp = function(a, b) {                    return dfc(primer(a), primer(b));                };            }            if (reverse) {                return function(a, b) {                    return -1 * cmp(a, b);                };            }            return cmp;        };    // actual implementation    sort_by = function() {        var fields = [],            n_fields = arguments.length,            field, name, reverse, cmp;        // preprocess sorting options        for (var i = 0; i < n_fields; i++) {            field = arguments[i];            if (typeof field === 'string') {                name = field;                cmp = default_cmp;            }            else {                name = field.name;                cmp = getCmpFunc(field.primer, field.reverse);            }            fields.push({                name: name,                cmp: cmp            });        }        // final comparison function        return function(A, B) {            var a, b, name, result;            for (var i = 0; i < n_fields; i++) {                result = 0;                field = fields[i];                name = field.name;                result = field.cmp(A[name], B[name]);                if (result !== 0) break;            }            return result;        }    }}());function checkLine() {	if(window.posEnableSortOnCourseThenOnKitchenName == 1) {		var table = document.getElementById("receiptItemsList");		console.log("test");		for (var i = 0, row; row = table.rows[i]; i++) {		   //iterate through rows		   //rows would be accessed using the "row" variable assigned in the for loop		   console.log(row.cells[0].innerHTML);		   if(row.cells[0].innerHTML == 1)		      row.className = "topLine";		}	}}function checkNotZero(value) {	for(var key in value){		if(value.hasOwnProperty(key))			if(value[key].tips > 0)				return true;	}	return false;}function calculateTip(totalPayments) {	var totalTip = 0;	for(var key in totalPayments) {		if(totalPayments.hasOwnProperty(key))			totalTip += totalPayments[key].tips;	}	return totalTip;}function deleteHeader(id) {	$("#" + id).remove();}function calculateAdditionsPrices(additions) {	var total = 0;	for(var key in additions) {		if(additions.hasOwnProperty(key))			total += additions[key].price * additions[key].amount;	}	return total;}function calculateSubtotal(receiptItems) {    var subtotal = 0;    for(var key in receiptItems) {        if(receiptItems.hasOwnProperty(key)) {            var price = (receiptItems[key].price * receiptItems[key].amount) / (100 + receiptItems[key].vat) * 100;            console.log("Price: " + price);            subtotal += price;            if(receiptItems[key].pId == 99999) {                window.posNoDiscount = 1;                window.posDiscount = receiptItems[key].price;            }            for(var addition in receiptItems[key].additionValues) {                if(receiptItems[key].additionValues.hasOwnProperty(addition))                    subtotal += ((receiptItems[key].additionValues[addition].price * receiptItems[key].additionValues[addition].amount) / (100 + receiptItems[key].vat) * 100);            }            console.log("total item: " + subtotal);        }    }    return subtotal;}function htmlForTextWithEmbeddedNewlines(text) {    var htmls = [];    var lines = text.split(/\\n/);    // The temporary <div/> is to perform HTML entity encoding reliably.    //    // document.createElement() is *much* faster than jQuery('<div/>')    // http://stackoverflow.com/questions/268490/    //    // You don't need jQuery but then you need to struggle with browser    // differences in innerText/textContent yourself    var tmpDiv = jQuery(document.createElement('div'));    for (var i = 0 ; i < lines.length ; i++) {        htmls.push(tmpDiv.text(lines[i]).html());    }    return htmls.join("<br/>");}function roundToFiveCents(v) {  return (Math.round(v*20)/20).toFixed(2) + '';}function combineItems(receiptItems) {	var receiptItemsToArray = new Array();	// Store all receipt items in an array	for(var receiptItem in receiptItems)		if(receiptItems.hasOwnProperty(receiptItem))			receiptItemsToArray.push(receiptItems[receiptItem]);	var combinedArray = new Array();	var checkedIds = new Array();	// Go over the different receipt items	for(var i = 0; i < receiptItemsToArray.length; i++) {		console.log(receiptItemsToArray[i].name);		// Store first item		if(i == 0) {			combinedArray.push(receiptItemsToArray[i]);			checkedIds.push(receiptItemsToArray[i].pOid);		}		else {			// Check if pOid has already been added to combinedArray			var foundIndex = checkedIds.allIndexOf(receiptItemsToArray[i].pOid);			if(foundIndex < 0) {				// The pOid has not been added yet				combinedArray.push(receiptItemsToArray[i]);				checkedIds.push(receiptItemsToArray[i].pOid);							}			else if(foundIndex.length > 1) {				var flag = 0;				// Check each index to check if the product has the same details as the one stored				for(var index = 0; index < foundIndex.length; index++) {					// Check if the product has the same details as the one stored					if(isSameProduct(combinedArray[foundIndex[index]], receiptItemsToArray[i])) {						combinedArray[foundIndex[index]].amount += receiptItemsToArray[i].amount;						flag++;					}								}				if(flag < 1) {					combinedArray.push(receiptItemsToArray[i]);					checkedIds.push(receiptItemsToArray[i].pOid);				}				else if(flag > 1) {					console.log("Something went wrong here. This is not possible.");				}			}			else {				// Check if the product has the same details as the one stored				if(isSameProduct(combinedArray[foundIndex], receiptItemsToArray[i])) {					combinedArray[foundIndex].amount += receiptItemsToArray[i].amount;				}				else {					combinedArray.push(receiptItemsToArray[i]);					checkedIds.push(receiptItemsToArray[i].pOid);								}			}		}	}	var correctArray = new Array();		for(var key in combinedArray)		if(combinedArray.hasOwnProperty(key))			if(combinedArray[key].amount != 0)				correctArray.push(combinedArray[key]);	return correctArray;}function isSameProduct(storedReceiptItem, newReceiptItem) {	if(storedReceiptItem.name == newReceiptItem.name) {		// Check if unit price is the same		if(storedReceiptItem.price == newReceiptItem.price) {			// Check if the additions are the same			if(areSameAdditions(storedReceiptItem.additionValues, newReceiptItem.additionValues))				return true;			else				return false;		}		else			return false;	}	else {		return false;	}}function areSameAdditions(storedAdditions, newAdditions) {	var storedAdditionsToArray = new Array();	var newAdditionsToArray = new Array();	// Store all additions in an array	for(var addition in storedAdditions)		if(storedAdditions.hasOwnProperty(addition))			storedAdditionsToArray.push(storedAdditions[addition]);	for(var addition in newAdditions)		if(newAdditions.hasOwnProperty(addition))			newAdditionsToArray.push(newAdditions[addition]);	storedAdditionsToArray.sort(compareAdditions);	newAdditionsToArray.sort(compareAdditions);	if(storedAdditionsToArray.length == newAdditionsToArray.length) {		var flag = 0;		for(var i = 0; i < storedAdditionsToArray.length; i++) {			if(storedAdditionsToArray[i].additionId == newAdditionsToArray[i].additionId				&& storedAdditionsToArray[i].name == newAdditionsToArray[i].name				&& storedAdditionsToArray[i].price == newAdditionsToArray[i].price				&& storedAdditionsToArray[i].oid == newAdditionsToArray[i].oid				&& storedAdditionsToArray[i].priceWithoutVAT == newAdditionsToArray[i].priceWithoutVAT)				flag++;			else				return false;		}		if(flag > 0)			return true;		else			return false;	}	else		return false;}function compareAdditions(a,b) {  if (a.oid < b.oid)     return -1;  if (a.oid > b.oid)    return 1;  return 0;}function addReceiptItemsAmountToAdditions(receiptItems) {	for(var key in receiptItems) {		if(receiptItems.hasOwnProperty(key)) {			for(var key2 in receiptItems[key].additionValues)				if(receiptItems[key].additionValues.hasOwnProperty(key2))					receiptItems[key].additionValues[key2].amount = receiptItems[key].amount;		}	}}function productIsOffert(productName) {	if(productName.indexOf('*') > -1)		return true;	return false;}function sortNumber(a,b) {    return a - b;}function calculateTotal() {	var total = Number($("#subtotalValue").text()) + Number($("#vatValue").text());	if(checkIfNotZeroEmptyOrNull($("#gratuityValue").text()))		total += Number($("#gratuityValue").text());	$("#totalValue").text((Number(total)).toFixed(2));}	/*http://ec2.posios.com:8080/posimages/demo_10/images/users/*/var completeReceipt = {company:{"digitalMenuCardUrl":"http://www.posios.be","email":"","smtpPort":null,"enforceStock":false,"notifyKitchen":true,"imageUrl":"http://www.posios.com","shouldWarnIfNonPrintedItems":false,"showDayReportTableDetails":false,"gsm":"","url":null,"smtpUserName":null,"account":null,"smtpPassword":null,"productBigFontSize":16,"type":null,"timezone":4,"info":"","invoiceNumberTemplate":null,"openingstime":0,"name":"JUnit","generateClosingTimeReport":false,"imageLocation":"","oid":8421,"zip":"9070","shouldGoToTablesWhenNothingNeedsToBePrinted":false,"users":[],"showProductReportAdditionValueDetails":false,"smtpHost":null,"takeawayPopup":true,"autoLogin":false,"street":"Unitstreet","city":"Ghent","streetNumber":"1","country":"United States","showDayReportProductDetails":false,"showDayReportCategoryDetails":false,"showProductReportAdditionValues":false,"displayName":"JUNIT","fax":"","vat":"10","showDayReportDetails":false,"combineBarAndKitchen":false,"vatInclusive":true,"customerSelectionPopup":false,"productSmallFontSize":11,"telephone":"0494541334","currency":null,"closingtime":0},receipt:{"invoiceNumber":null,"url":"","modificationDate":1388400448803,"userId":18029,"sequenceNumber":223,"customerId":0,"oid":"79468","info":"","type":"restaurant","znumber":0,"printDate":1388400448803,"parentId":"0","vat":0,"deliveryDate":0,"lockDeviceIdentifier":"C4B5CC94-C51C-4FE6-AE01-3742626814D4","numberOfCustomers":0,"receiptItems":[{"displayName":"","totalPrice":1,"modifierUserId":18029,"priceTypeId":0,"additionUpdateId":0,"modificationDate":1388400447459,"barcode":null,"name":"Zero zero zero","pOid":78259,"oid":1226000,"info":"","creatorUserId":18029,"receiptId":79468,"riReceiptId":1,"vat":0,"customerNr":0,"barcode2":null,"amount":1,"pId":"1","price":0,"kitchenName":"Zero zero zero","additionValues":[{"additionId":577,"name":"1 blokje","price":1,"oid":1461,"priceWithoutVAT":0,"info":"1 blokje"}],"statusId":0,"parentRiReceiptId":0,"deliveryVat":0,"creationDate":1388400447459,"status":"executed","takeawayVat":0},{"displayName":"","totalPrice":0,"modifierUserId":18029,"priceTypeId":0,"additionUpdateId":0,"modificationDate":1388400447459,"barcode":null,"name":"Zero zero zero","pOid":78259,"oid":1226001,"info":"","creatorUserId":18029,"receiptId":79468,"riReceiptId":2,"vat":0,"customerNr":0,"barcode2":null,"amount":1,"pId":"1","price":0,"kitchenName":"Zero zero zero","additionValues":[{"additionId":577,"name":"2 blokjes","price":0,"oid":1462,"priceWithoutVAT":0,"info":""}],"statusId":0,"parentRiReceiptId":0,"deliveryVat":0,"creationDate":1388400447459,"status":"executed","takeawayVat":0},{"displayName":"","totalPrice":0,"modifierUserId":18029,"priceTypeId":0,"additionUpdateId":0,"modificationDate":1388400447459,"barcode":null,"name":"Zero zero zero","pOid":78259,"oid":1226002,"info":"","creatorUserId":18029,"receiptId":79468,"riReceiptId":3,"vat":0,"customerNr":0,"barcode2":null,"amount":1,"pId":"1","price":0,"kitchenName":"Zero zero zero","additionValues":[{"additionId":577,"name":"Nico is ne loser","price":0,"oid":1463,"priceWithoutVAT":0,"info":""}],"statusId":0,"parentRiReceiptId":0,"deliveryVat":0,"creationDate":1388400447459,"status":"executed","takeawayVat":0}],"payed":false,"deliveryDelay":0,"actionReceiptItems":[],"hasChildren":false,"tableId":"121866","footer":null,"foid":0,"dayReceiptId":0,"creationDate":1388400435615,"status":"waiting for payment","stamp":"","total":1},template:{"showCustomerInfo":0,"fontName":"Arial","bigFontSize":45,"printTemplateTypeId":1,"nrOfDecimals":0,"companyId":8421,"showWaiterTableTime":1,"signalAccessory":0,"amountWidth":3,"promotionText":"Thank you for visiting Niche - please come again soon!","type":"Receipt","templateUrl":"http://dev.posios.com:8080/posimages/junit_17441/templates/4198.html","smallFontName":"Arial","printerId":486,"fontSize":25,"priceWidth":6,"productDisplayNamesIndex":0,"name":"Receipt","oid":4198,"showCompanyInfo":1,"smallFontSize":16,"logoUrl":"http://dev.posios.com:8080/posimages/junit_17441/images/companyLogo/Niche%20in%20black%20sm.jpg","bottomLogoUrl":null,"showVat":1,"printNameId":0,"showTotalPrice":1,"bigFontName":"Arial-BoldMT","thankYouText":"Thanks and see you soon!","showSequenceNumber":0,"title":"Rosebery Avenue","nrOfDecimalsToRoundVATTo":2,"nrWidth":0,"template":null},user:{"visible":true,"socialSecurityNumber":"","city":"","uuid":"bd1522b6-3879-490b-b800-1f45882a309a","streetNumber":"","zip":"","companyId":8421,"imageLocation":"http://dev.posios.com:8080/posimages/MAIN/images/standarduser.png","sex":null,"oid":18029,"type":"employee","password":"","email":"nicolas.deletter@posios.com","serverport":0,"serverprotocol":null,"serverextension":null,"customerId":0,"street":"","telephone":"","lastname":"","username":"Nicolas","role":null,"country":"","server":null,"age":0,"lastClockInTime":0,"creationDate":0,"gsm":"","firstname":"","defaultFloorId":4572},table:{"imageLocation":"http://dev.posios.com:8080/posimages/MAIN/images/table1.png","status":"free","numberOfClients":4,"chairImageLocation":"http://dev.posios.com:8080/posimages/MAIN/images/whitechair.png","x":130,"width":100,"ellipse":false,"type":"restaurant","y":23,"oid":"121866","height":40,"companyId":8421,"info":"","rotation":0,"floorId":4572,"name":"T-2","tableOrder":0,"zindex":0},vat:{"0":1},barItems:[],kitchenItems:[],payments:[],device:{"applicationVersion":"2.0.5210","type":null,"name":"iPad","deviceModel":"iPad","companyId":8421,"applicationId":"Restaurant Butler","optout":0,"oid":8966,"printTemplateId":0,"deviceVersion":"6.1.3","deviceId":"C4B5CC94-C51C-4FE6-AE01-3742626814D4"}, customer:{"email":null,"language":null,"deliveryStreetNumber":null,"username":null,"clientId":0,"deliveryCity":null,"birthYear":0,"lastname":null,"companyId":0,"gsm":null,"uuid":null,"type":null,"visible":false,"role":null,"birthMonth":0,"sex":null,"partnerCustomerId":0,"deliveryCountry":null,"deliveryStreet":null,"deliveryZip":null,"firstname":null,"creationDate":0,"imageLocation":null,"oid":0,"zip":null,"vatNumber":null,"lastVisitDate":0,"street":null,"city":null,"birthDay":0,"country":null,"streetNumber":null,"password":null,"receiveNewsLetter":false,"age":0,"verified":false,"telephone":null,"socialSecurityNumber":null,"credits":0}, productCategories:[{"displayName":null,"printTemplateId":4172,"deliveryVat":0,"vat":0,"printer":"","additionIds":[],"products":[{"dealer":"","displayName":"","visible":true,"priceTypeId":0,"priceWithoutVAT":0,"totalPrice":0,"imageLocation":"","takeawayPrice":0,"stockAmount":-2,"name":"Zero zero zero","manufacturer":"","oid":78259,"info":"","tempTime":0,"barcode":"","vat":0,"displayNames":["Zero zero zero","Zero zero zero"],"deliveryPrice":0,"cost":0,"pId":"1","price":0,"kitchenName":null,"deliveryPriceWithoutVAT":-1,"orderAmount":0,"takeawayPriceWithoutVAT":-1,"additionIds":[577],"productTypeId":4278190080,"deliveryVat":0,"takeawayVat":0,"subProductIds":null,"productCategoryId":32565}],"takeawayVat":0,"oid":32565,"printOrder":1,"info":"Zero valued products","companyId":8421,"name":"Zero valued products","printTemplateIds":[4172],"imageLocation":"http://dev.posios.com:8080/posimages/MAIN/images/productCategories/aperitief.png"}], additionValues: [{"additionId":577,"name":"1 blokje","price":1,"oid":1461,"priceWithoutVAT":0,"info":"1 blokje"},{"additionId":577,"name":"2 blokjes","price":0,"oid":1462,"priceWithoutVAT":0,"info":""},{"additionId":577,"name":"Nico is ne loser","price":0,"oid":1463,"priceWithoutVAT":0,"info":""}]}; /*console.log(completeReceipt);*/ try {jQuery(document).ready(function($) {search(completeReceipt);location.href = 'posios://print';});} catch(e) {'print error:' + e.message +' '+ e;}var generatedCount = 0;function search(completeReceipt) {	console.log('testje:' + completeReceipt.company.displayName);		// Make sure completeReceipt is globally accessible	window.completeReceipt = completeReceipt;	// When set to 1, an underline will be added to the title.	window.posTitleWithUnderline = 0;	// When set to 1, a line will be drawn underneath the receipt info.	window.posEnableInfoSubline = 1;	// When set to 1, the prices will be shown.	window.posShowPrice = 1;	// When set to 1, additions of value zero will be printed.	window.posShowZeroValuedAdditions = 0;	// When set to 1, the prices of the products with a value of zero will be printed.	window.posShowZeroValuedPricesProducts = 0;	// When set to 1, additions will be printed.	window.posShowAdditions = 1;	// When set to 1, a line will be drawn underneath the body of the receipt.	window.posEnableBodySubline = 0;	// When set to 1, a line will be drawn underneath the change.	window.posEnableChangeSubline = 0;	// When set to 1, a line will be drawn underneath the tip.	window.posEnableTipSubline = 0;	// When set to 1, a line will be drawn underneath the VAT.	window.posEnableVATSubline = 0;	// When set to 1, a line will be drawn underneath the thank you text.	window.posEnableThankYouSubline = 1;	// When set to 1, a line will be drawn underneath the promotion text.	window.posEnablePromotionSubline = 1;	// When set to 1, a thin line will be drawn around the promotion text. 2 will draw a medium one, 3 a thick one. Default: no frame.	window.posThicknessOfFramePromotion = 2;	// When set to 1, the bottom logo will be printed provided the URL is correct.	window.posShowBottomLogo = 1;	// When set to 1, a line will be drawn underneath the bottom logo.	window.posEnableBottomLogoTopline = 0;	// When set to 1, the customer info will be shown at the bottom of the receipt.	window.posShowCustomerInfo = 0;	// When set to 1, a line will be drawn underneath the customer info.	window.posEnableCustomerSubline = 1;	// When set to 1, the customer information will be centered. *** When enabling this option, reset the width of the div with ID centeredCompanyInfo so that the div	// will actually be in the center ***.	window.posEnableCustomerInfoCentering = 0;	// Set this value to order by. Supported values are 'receiptItems.name', 'receiptItems.kitchenName', 'receiptItems.pId' (PLU), 'receiptItems.modificationDate'.	window.posOrderBy = "";	// When set to 1, the items will be ordered in ascending order. -1 Will do the opposite.	window.posOrderDirection = -1;	// When set to 1, the payments will be shown.	window.posShowPayments = 1;	// When set to 1, a custom sort function is called.	window.posEnableSortOnCourseThenOnKitchenName = 0;	// When set to 1, a subline will be drawn underneath total amount due.	window.posEnableAmountDueSubline = 1;	// When set to 1, the payment header "Payment" and "Amount" will be shown.	window.posShowHeadersPaymentTypes = 1;	// When set to 1, a line will be drawn between the courses.	window.posEnableCourseLines = 0;	// When set to 1, only one VAT percentage will be used for all products. (US)	window.posOneVAT = 1;	// When set to 1, offerts will be shown even though products with price zero are not shown.	window.posShowOfferts = 1;	// When set to 1, the receipt items will be combined. Do NOT try to combine this function with window.posEnableSortOnCourseThenOnKitchenName.	window.posEnableCombineItems = 1;	// When set to 1, multiple debug lines will be printed to see where the error occurs when princing the receipt.	window.posEnableDebug = 0;	// These are values which test if objects are present. Do not touch.	window.posCustomerAvailable = 0;	window.posCompanyAvailable = 0;	window.posReceiptAvailable = 0;	window.posTemplateAvailable = 0;	window.posUserAvailable = 0;	window.posTableAvailable = 0;	window.posVatAvailable = 0;	window.posBarItemsAvailable = 0;	window.posKitchenItemsAvailable = 0;	window.posPaymentsAvailable = 0;	window.posProductCategoriesAvailable = 0;	window.posAdditionValuesAvailable = 0;	window.posCount = 0;	window.posNoDiscount = 0;	window.posDiscount = 0;	/*	* Hiermee kan je een element verbergen.	*	* style="visibility:hidden"	*/		var data = eval(completeReceipt.receipt);	var results = data['receiptItems'];	if (window.posOneVAT == 1)		window.posVAT = completeReceipt.receipt.receiptItems[0].vat;	if (window.posEnableSortOnCourseThenOnKitchenName == 1) {		var count = 0;		for ( property in completeReceipt )		{		   if(completeReceipt.hasOwnProperty(property))		   {		      count++;		   }		}		var productArray = [];		for (var key in completeReceipt.receipt.receiptItems) {		   if (completeReceipt.receipt.receiptItems.hasOwnProperty(key) ){		   		productArray.push(completeReceipt.receipt.receiptItems[key]);		   		//added 11/24/13		   		window.posNoDiscount = 0;		   		window.posDiscount = 0;		   }		}		for(var i = 0; i < productArray.length; i++) {			for (var key in completeReceipt.productCategories) {				if(completeReceipt.productCategories.hasOwnProperty(key))					for(var key2 in completeReceipt.productCategories[key].products)						if(completeReceipt.productCategories[key].products.hasOwnProperty(key2))							for(var j = 0; j < completeReceipt.productCategories[key].products[key2].displayNames.length; j++) {								if(completeReceipt.productCategories[key].products[key2].displayNames[j] == productArray[i].name)										productArray[i].order = completeReceipt.productCategories[key].printOrder;							}			}		}		cmp = function(x, y) {	    	return x > y ? 1 : x < y ? -1 : 0; 		};		//var sortedArray = productArray.sort(dynamicSort("order"));		var sorted2 = productArray.sort(function(a, b){	    //note the minus before -cmp, for descending order	    	return cmp ( 	        	[cmp(a.order, b.order), cmp(a.name, b.name)], 	        	[cmp(b.order, a.order), cmp(b.name, a.name)]	    	);		});		for(var key in sorted2) {			if(sorted2.hasOwnProperty(key)) {				if(key != 0) {					if(sorted2[key].order > sorted2[key-1].order)						sorted2[key].line = 1;				}			}		}	}	else {		if(window.posOrderBy != "")			sortJsonArrayByProperty(results, window.posOrderBy, window.posOrderDirection);	}		if(window.posEnableBodySubline == 1) {		var table = document.getElementById("receipt");		table.className = "borderBottom";	}		if(window.posEnableInfoSubline == 1) {		var table = document.getElementById("receiptItemsList");		table.className = "borderTop";	}		if(window.posEnableChangeSubline == 1) {		var table = document.getElementById("change");		table.className = "borderBottom";	}			if(window.posEnableVATSubline == 1) {		var table = document.getElementById("vat");		table.className = "borderBottom";	}		if(window.posEnableTipSubline == 1 && checkNotZero(completeReceipt.payments)) {		var table = document.getElementById("totalTip");		table.className = "borderBottom";	}	if(window.posEnableAmountDueSubline == 1) {		var table = document.getElementById("amountDue");		table.className = table.className + " borderBottom";	}	if(window.posCustomerAvailable == 1) {		if (window.posShowCustomerInfo == 1 && window.posEnableCustomerSubline == 1) {			var table = document.getElementById("takeAwayInfo");			table.className = "borderBottom";		}	}		if(window.posEnableDebug == 1)		$('#errors').append("<p>Printing will start.</p>");	if(checkIfNotZeroEmptyOrNull(completeReceipt.customer))		window.posCustomerAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.company))		window.posCompanyAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.receipt))		window.posReceiptAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.template))		window.posTemplateAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.user))		window.posUserAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.table))		window.posTableAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.vat))		window.posVatAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.barItems))		window.posBarItemsAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.kitchenItems))		window.posKitchenItemsAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.payments))		window.posPaymentsAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.productCategories))		window.posProductCategoriesAvailable = 1;	if(checkIfNotZeroEmptyOrNull(completeReceipt.additionValues))		window.posAdditionValuesAvailable = 1;	$( "#headerTemplate" ).tmpl(completeReceipt).appendTo("#header");		if(window.posEnableDebug == 1)		$('#errors').append("<p>Header printed.</p>");		if(completeReceipt.template.showCompanyInfo==1){		$( "#footerTemplate" ).tmpl(completeReceipt).appendTo("#footer");		$('.spreadEvenly').first().html(htmlForTextWithEmbeddedNewlines(completeReceipt.template.thankYouText));	}		if(window.posEnableDebug == 1)		$('#errors').append("<p>Company info has been printed.</p>");		//$( "#receiptItemsTemplate" ).tmpl( receiptItemsArray ).appendTo( "#receiptItemsList" );	if(window.posEnableSortOnCourseThenOnKitchenName == 1)		completeReceipt.receipt.receiptItems = sorted2;	if(window.posEnableCombineItems == 1 && window.posEnableSortOnCourseThenOnKitchenName == 0)		completeReceipt.receipt.receiptItems = combineItems(completeReceipt.receipt.receiptItems);	addReceiptItemsAmountToAdditions(completeReceipt.receipt.receiptItems);	$( "#receiptItemsTemplate" ).tmpl( completeReceipt.receipt.receiptItems ).appendTo( "#receiptItemsList" );	if(window.posEnableDebug == 1)		$('#errors').append("<p>Receipt items have been printed.</p>");		if(completeReceipt.template.showTotalPrice==1){		$( "#receiptTotals" ).tmpl( completeReceipt.receipt ).appendTo( "#totals" );	}	//$( "#receiptTotalTemplate" ).tmpl( completeReceipt.receipt ).prependTo( "#totals" );	$("#receiptSubtotal").tmpl(completeReceipt.receipt).appendTo("#subtotal");	// added 11/24/13	if(window.posNoDiscount == 1) {	    var tempValue = $("#totals td:nth-child(2)").text();	    tempValue = Number(tempValue) + window.posDiscount;	    tempValue = roundToFiveCents(tempValue);	    $("#totals td:nth-child(2)").html('<b>' + tempValue + '<b/>');	}	if(window.posEnableDebug == 1)		$('#errors').append("<p>Receipt totals have been printed.</p>");	//Zorgt voor dat vat gelezen wordt	var vatArray = [];					for(var key in completeReceipt.vat) {		if(completeReceipt.vat.hasOwnProperty(key)) {			if(completeReceipt.vat[key].vat != "0")				vatArray.push({vat:key,price:completeReceipt.vat[key]});		}	}	vatArray.sort();		if(window.posEnableDebug == 1)		$('#errors').append("<p>VAT has been printed.</p>");		completeReceipt.vat = vatArray;				if(completeReceipt.template.showVat==1 && window.posNoDiscount == 0){		$("#vat").show();		$( "#vatTemplate" ).tmpl( vatArray ).appendTo( "#vat" );		console.log(vatArray);	}else{		$("#vat").hide();	}	if(checkIfNotZeroEmptyOrNull(completeReceipt.receipt.actionReceiptItems))		$("#gratuityTemplate").tmpl(completeReceipt.receipt.actionReceiptItems).appendTo("#gratuity");		if(window.posEnableDebug == 1)		$('#errors').append("<p>VAT2 has been printed.</p>");		if(typeof completeReceipt.payments !== "undefined") {			if(completeReceipt.payments.length > 0) {				$( "#paymentTypeTemplate" ).tmpl( completeReceipt.payments ).appendTo( "#paymentsTable" );				if(window.posShowHeadersPaymentTypes == 0)					deleteHeader("paymentHeader");				//$( "#tablePaymentTypes" ).tmpl( ).prependTo( "#paymentsTable" );			}				if (completeReceipt.payments.length == 0) {				//$( "#paymentTypeTemplate" ).tmpl( completeReceipt.payments ).appendTo( "#amountDue" );			$( "#paymentsTable" ).remove();		}		if (completeReceipt.payments && completeReceipt.payments.length > 0)			$( "#totalAmountTemplate" ).tmpl( completeReceipt ).appendTo( "#totalAmount" );	}	if(window.posEnableDebug == 1)		$('#errors').append("<p>Payments have been printed.</p>");		if(getTotalTip(completeReceipt.payments) > 0) {		$( "#totalTipTemplate" ).tmpl( completeReceipt ).appendTo( "#totalTip" );	}	if(window.posEnableDebug == 1)		$('#errors').append("<p>Tip has been printed.</p>");	if (completeReceipt.payments && completeReceipt.payments.length > 0)				$( "#changeTemplate" ).tmpl( completeReceipt ).appendTo( "#change" );	if(window.posEnableDebug == 1)		$('#errors').append("<p>Change has been printed.</p>");		if(completeReceipt.receipt.url && completeReceipt.receipt.url !== undefined && completeReceipt.receipt.url !== null && completeReceipt.receipt.url !== ""){		}	if(document.getElementsByTagName('canvas')[0]) {		var canvas = document.getElementsByTagName('canvas')[0];		canvas.className = "floatRight";		canvas.id = "qrCode";		var theDiv = document.getElementById("restaurantInfo");		theDiv.appendChild(canvas);	}	if(completeReceipt.payments.length != 0 && calculateTip(completeReceipt.payments) > 0)		$("#amountDueTemplate").tmpl(completeReceipt).appendTo("#amountDue");	jQuery("[i21D='defaultFontSize']").each(function(i,e){	 //console.log($(e));	 $(e).css({"font-family":completeReceipt.template.fontName});	 $(e).css({"font-size":completeReceipt.template.fontSize});	});   	jQuery("[i21B='bigFontSize']").each(function(i,e){	 //console.log($(e));	 $(e).css({"font-family":completeReceipt.template.bigFontName});	 $(e).css({"font-size":completeReceipt.template.bigFontSize});	}); 		jQuery("[i21S='smallFontSize']").each(function(i,e){	 //console.log($(e));	 $(e).css({"font-family":completeReceipt.template.smallFontName});	 $(e).css({"font-size":completeReceipt.template.smallFontSize});	});  	if(window.posEnableSortOnCourseThenOnKitchenName == 1 && window.posEnableCourseLines == 1)    	checkLine();	if(window.posShowPrice == 0)		removePrice();	calculateTotal(); }		</script></head><body style="background:#fff">	<div id="errors"></div>	<div id="header"></div>	<div id="receipt" i21D='defaultFontSize'>        <table id="receiptItemsList">            <tr>            	<th style="display:none;"></th>                <th id="amountItems" align="left">#</th>                <th id="productItem" align="left">Item</th>                <th id="priceHide" align="right">Price</th>            </tr>        </table>	</div>	<table id="subtotal">	</table>    <table id="vat" i21D='defaultFontSize'>    </table>    <table id="gratuity" i21D='defaultFontSize'>    </table>   	<table id="totals">  	</table> 	<table id="amountDue" class="widthHundred">  	</table>       <table id="netPrice">    </table>       <table id="paymentsTable">		<tr i21D='defaultFontSize' id="paymentHeader"><th align="left">Payment</th><th align="right">Amount</th></tr>    	</table>  	<table id="totalAmount">  		<tr><th></th><th></th></tr>  	</table>  	<table id="change">      </table>  	<table id="totalTip">  	</table>           <div id="footer">    </div>    <div id="footer2" i21D='defaultFontSize'>    <center>    <br/>    Follow us!<br/>	Twitter @EdelweissLAX<br/>	facebook.com/ChaletEdelweissLAX    </center></body></html>